/**
 * M贸dulo: Esquema del Infolist de Categor铆as para Filament
 *
 * Este archivo define las entradas y secciones que se muestran en la vista
 * de detalles (View) del recurso Category dentro del panel de Filament.
 * Incluye visualizaci贸n de im谩genes, estados y metadatos.
 *
 * Se documenta en espa帽ol siguiendo las pol铆ticas del proyecto.
 *
 * Exports:
 *  - CategoryInfolist::configure(Schema): Schema
 *
 * Dependencies:
 *  - Filament >= 3.0
 *  - Laravel >= 10.0
 *  - App\Models\Category
 *
 * Author: (a帽ade tu nombre si lo deseas)
 * Created: 2025-11-12
 */

<?php

namespace App\Filament\Resources\Categories\Schemas;

use App\Models\Category;
use Filament\Infolists\Components\IconEntry;
use Filament\Infolists\Components\ImageEntry;
use Filament\Infolists\Components\TextEntry;
use Filament\Infolists\Components\Section; // Importaci贸n correcta para Infolists
use Filament\Schemas\Schema;

/**
 * Clase que encapsula la configuraci贸n del infolist de categor铆as.
 *
 * Responsibilities:
 *  - Declarar las entradas de informaci贸n (text, image, icon)
 *  - Organizar informaci贸n en secciones para mejor legibilidad
 *  - Configurar visibilidad condicional y formatos de datos
 */
class CategoryInfolist
{
    /**
     * Configura la instancia de Filament\Schema\Schema usada en la p谩gina
     * View del recurso Category.
     *
     * Muestra informaci贸n detallada del registro en secciones organizadas,
     * con soporte para im谩genes, estados booleanos y metadatos.
     *
     * Args:
     *  - $schema (Schema): instancia de Filament Schema que ser谩 mutada.
     *
     * Returns:
     *  - Schema: la misma instancia configurada y retornada para encadenado.
     *
     * Note:
     *  - Utiliza closures para visibilidad condicional basada en el estado del registro.
     */
    public static function configure(Schema $schema): Schema
    {
        return $schema
            ->components([

                // === SECCIN 1: DETALLES PRINCIPALES Y ESTADO ===
                \Filament\Schemas\Components\Section::make('Informaci贸n General')
                    ->columns(2) // Divide la secci贸n en 2 columnas para mejor uso del espacio
                    ->description('Detalles principales y estado actual de la categor铆a.')
                    ->schema([

                        // Columna 1
                        TextEntry::make('name')
                            ->label('Nombre'),

                        // Columna 2
                        TextEntry::make('slug')
                            ->label('Slug')
                            ->copyable() // UX: Permite copiar el slug con un clic
                            ->icon('heroicon-o-link'),

                        // Imagen de la Categor铆a (Fix para que se muestre)
                        ImageEntry::make('image')
                            ->label('Imagen Principal')
                            //  CLAVE: Especificar el disco para que pueda generar la URL p煤blica
                            ->disk('public')
                            ->height(150) // UX: Le da un tama帽o decente para verse bien
                            ->width('auto')
                            ->columnSpan(1) // Ocupa media columna
                            ->placeholder('Sin imagen.'),

                        // Estado Activo (Mejorado con Iconos y Colores)
                        IconEntry::make('is_active')
                            ->label('Estado de Visibilidad')
                            ->columnSpan(1)
                            ->boolean()
                            ->trueIcon('heroicon-o-check-badge')
                            ->trueColor('success') // Color verde para activo
                            ->falseIcon('heroicon-o-x-circle')
                            ->falseColor('danger'), // Color rojo para inactivo
                    ]),

                // === SECCIN 2: DESCRIPCIN (Ancho completo) ===
                \Filament\Schemas\Components\Section::make('Descripci贸n')
                    ->schema([
                        TextEntry::make('description')
                            ->label('Contenido Detallado')
                            ->markdown() // Si permites Markdown en la descripci贸n, esto lo renderiza
                            ->placeholder('No se proporcion贸 una descripci贸n detallada.')
                            ->columnSpanFull(),
                    ]),

                // === SECCIN 3: METADATA DEL SISTEMA ===
                \Filament\Schemas\Components\Section::make('Metadata')
                    ->columns(3) // Usamos 3 columnas para optimizar espacio en el pie
                    ->collapsible() // UX: Permite al usuario colapsar la secci贸n menos importante
                    ->schema([
                        TextEntry::make('created_at')
                            ->label('Fecha de Creaci贸n')
                            ->dateTime('d/m/Y H:i') // Formato de fecha localizado
                            ->placeholder('-'),

                        TextEntry::make('updated_at')
                            ->label('ltima Modificaci贸n')
                            ->dateTime('d/m/Y H:i')
                            ->placeholder('-'),

                        // Solo visible si el registro est谩 en la papelera (Soft Deletes)
                        TextEntry::make('deleted_at')
                            ->label('Fecha de Eliminaci贸n')
                            ->dateTime('d/m/Y H:i')
                            ->badge() // Se muestra como una etiqueta destacada
                            ->color('danger')
                            ->visible(fn(Category $record): bool => $record->trashed()),
                    ]),
            ]);
    }
}
